<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Mina 
</title>
    <link href="style.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Shanti:400|PT+Sans:700,700italic' rel='stylesheet' type='text/css'>
    
</head>
<body class='literate toc github'>
  
    <a href="https://github.com/nadarei/mina"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://a248.e.akamai.net/assets.github.com/img/e6bef7a091f5f3138b8cd40bc3e114258dd68ddf/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub"></a>
  
  <div id='all'>

<hgroup class="header"><h1 id="mina">Mina <a href="http://travis-ci.org/nadarei/mina"><img src="https://secure.travis-ci.org/nadarei/mina.png?branch=master" alt="status"></a>
</h1></hgroup><p class=" brief">Really fast deployer and server automation tool.</p>

<p>Mina works really fast because it's a deploy Bash script generator. It
generates an entire procedure as a Bash script and runs it remotely in the
server.</p>

<p>Compare this to the likes of Vlad or Capistrano, where each command
is ran separately on their own SSH sessions. Mina only creates <em>one</em> SSH
session per deploy, minimizing the SSH connection overhead.</p>

<pre class=" lang- prettyprint"><code># Install the gem yourself
$ git clone https://github.com/nadarei/mina.git
$ cd mina
$ gem build *.gemspec
$ gem install *.gem
</code></pre>

<section class=" h2 features"><h2 id="features">Features</h2>

<ul>
<li><p><strong>Really fast.</strong> Mina only makes one SSH connection per deploy. It
builds a Bash script and executes it remotely, reducing the overhead of
creating SSH connections to do processing locally (like Vlad or Capistrano
does).</p></li>
<li><p><strong>Safe deploys.</strong> New releases are built on a temp folder. If the deploy
script fails at any point, the build is deleted and it'd be as if nothing
happened.</p></li>
<li><p><strong>Locks.</strong> Deploy scripts rely on a lockfile ensuring only one deploy can
happen at a time.</p></li>
<li><p><strong>Works with anything.</strong> While Mina is built with Rails projects it
mind, it can be used on just about any type of project deployable via SSH,
Ruby or not.</p></li>
<li><p><strong>Built with Rake.</strong> Setting up tasks will be very familiar! No YAML files
here. Everything is written in Ruby, giving you the power to be as flexible in
your configuration as needed.</p></li>
</ul></section><section class=" h2 setting_up_a_project"><h2 id="setting_up_a_project">Setting up a project</h2>

<p>Let's deploy a project using Mina.</p>

<section class=" h3 step_1_create_a_config_deploy_rb"><h3 id="step_1_create_a_config_deploy_rb">Step 1: Create a config/deploy.rb</h3>
<pre class=" lang- prettyprint right"><code>$ mina init
Created config/deploy.rb.
</code></pre>

<p>In your project, type <code>mina init</code> to create a sample of this file.</p>

<p>This is just a Rake file with tasks!</p>

<br class="post-pre">

<p class=" after-pre">See <a href="#about_deployrb">About deploy.rb</a> for more info on what <em>deploy.rb</em> is.</p>

</section><section class=" h3 step_2_set_up_your_server"><h3 id="step_2_set_up_your_server">Step 2: Set up your server</h3>
<pre class=" lang- prettyprint right"><code># SSH into your server, then:
$ mkdir /var/www/flipstack.com
$ chown -R username /var/www/flipstack.com

# Make sure 'username' is the same as what's on deploy.rb
</code></pre>

<p>Make a directory in your server called <code>/var/www/flipstack.com</code> (in <em>deploy_to</em>)
change it's ownership to the correct user.</p>

<br class="post-pre">

</section><section class=" after-pre h3 step_3_run_mina_setup"><h3 id="step_3_run_mina_setup" class=" after-pre">Step 3: Run 'mina setup'</h3>
<pre class=" lang- prettyprint right"><code>$ mina setup
-----&gt; Creating folders... done.
</code></pre>

<p>Now do <code>mina setup</code> to set up the <a href="#directory_structure">folder structure</a> in this
path. This will connect to your server via SSH and create the right directories.</p>

<br class="post-pre">

<p class=" after-pre">See <a href="#directory_structure">directory structure</a> for more info.</p>

</section><section class=" h3 step_4_deploy"><h3 id="step_4_deploy">Step 4: Deploy!</h3>
<pre class=" lang- prettyprint right"><code>$ mina deploy
-----&gt; Deploying to 2012-06-12-040248
       ...
       Lots of things happening...
       ...
-----&gt; Done.
</code></pre>

<p>Use <code>mina deploy</code> to run the <code>deploy</code> task defined in <em>config/deploy.rb</em>.</p>

<br class="post-pre">

</section></section><section class=" after-pre h2 command_line_options"><h2 id="command_line_options" class=" after-pre">Command line options</h2>

<ul>
<li><p><code>--verbose</code> - This will show commands being done on the server. Off by
default.</p></li>
<li><p><code>--simulate</code> - This will not invoke any SSH connections; instead, it will
simply output the script it builds.</p></li>
</ul></section><section class=" h2 about_deploy_rb"><h2 id="about_deploy_rb">About deploy.rb</h2>
<pre class=" lang- prettyprint right"><code class="ruby"># Sample config/deploy.rb
set :domain, 'your.server.com'

task :restart do
  queue 'sudo service restart apache'
end
</code></pre>

<p>The file <code>deploy.rb</code> is simply a Rakefile invoked by Rake. In fact, <code>mina</code> is
mostly an alias that invokes Rake to load <code>deploy.rb</code>.</p>

<p>As it's all Rake, you can define tasks that you can invoke using <code>mina</code>. In this
example, it provides the <code>mina restart</code> command.</p>

<br class="post-pre">

<p class=" after-pre">The magic of Mina is in the new commands it gives you.</p>

<p>The <code>queue</code> command queues up Bash commands to be ran on the remote server.
If you invoke <code>mina restart</code>, it will invoke the task above and run the queued
commands on the remote server <code>your.server.com</code> via SSH.</p>

<p>See <a href="#the_command_queue">the command queue</a> for more information on the <em>queue</em>
command.</p>

</section><section class=" h2 the_command_queue"><h2 id="the_command_queue">The command queue</h2>
<pre class=" lang- prettyprint right"><code class="ruby">set :user, 'john'
set :domain, 'flipstack.com'

task :logs do
  queue 'echo "Contents of the log file are as follows:"'
  queue "tail -f /var/log/apache.log"
end
</code></pre>

<p>At the heart of it, Mina is merely sugar on top of Rake to queue commands
and execute them remotely at the end.</p>

<p>Take a look at this minimal <em>deploy.rb</em> configuration:</p>

<br class="post-pre">

<pre class=" lang- prettyprint right"><code># Run it in simulation mode so we see the command it will invoke:
$ mina logs --simulate
(
  echo "Contents of the log file are as follows:"
  tail -f /var/log/apache.log
) | ssh john@flipstack.com -- bash -
</code></pre>
<p class=" after-pre">Once you type <code>mina logs</code> in your terminal, it invokes the <em>queue</em>d commands
remotely on the server using the command <code>ssh john@flipstack.com</code>.</p>

<br class="post-pre">

</section><section class=" after-pre h2 subtasks"><h2 id="subtasks" class=" after-pre">Subtasks</h2>
<pre class=" lang- prettyprint right"><code class="ruby">task :down do
  invoke :maintenance_on
  invoke :restart
end

task :maintenance_on
  queue 'touch maintenance.txt'
end

task :restart
  queue 'sudo service restart apache'
end
</code></pre>

<p>Mina provides the helper <code>invoke</code> to invoke other tasks from a
task.</p>

<br class="post-pre">

<p class=" after-pre">In this example above, if you type <code>mina down</code>, it simply invokes the other
subtasks which queues up their commands. The commands will be ran after
everything.</p>

</section><section class=" h2 deploying"><h2 id="deploying">Deploying</h2>
<pre class=" lang- prettyprint right"><code class="ruby">set :domain, 'flipstack.com'
set :user, 'flipstack'
set :deploy_to, '/var/www/flipstack.com'
set :repository, 'http://github.com/flipstack/flipstack.git'

task :deploy do
  deploy do
    # Put things that prepare the empty release folder here.
    # Commands queued here will be ran on a new release directory.
    invoke :'git:clone'
    invoke :'bundle:install'

    # These are instructions to start the app after it's been prepared.
    to :launch do
      queue 'touch tmp/restart.txt'
    end

    # This optional block defines how a broken release should be cleaned up.
    to :clean do
      queue 'log "failed deployment"'
    end
  end
end
</code></pre>

<p>Mina provides the <code>deploy</code> command which <em>queue</em>s up a deploy script for
you.</p>

<br class="post-pre">

<p class=" after-pre">It works by capturing the <em>queue</em>d commands inside the block, wrapping them
in a deploy script, then <em>queue</em>ing them back in.</p>

</section><section class=" h2 how_deploying_works"><h2 id="how_deploying_works">How deploying works</h2>

<p>Here is an example of a deploy! (Note that some commands have been simplified
to illustrate the point better.)</p>

<section class=" h3 step_1_build_it"><h3 id="step_1_build_it">Step 1: Build it</h3>
<pre class=" lang- prettyprint right"><code>$ mina deploy --verbose
-----&gt; Creating the build path
       $ mkdir tmp/build-128293482394
-----&gt; Cloning the Git repository
       $ git clone https://github.com/flipstack/flipstack.git . -n --recursive
       Cloning... done.
-----&gt; Installing gem dependencies using Bundler
       $ bundle install --without development:test
       Using i18n (0.6.0)
       Using multi_json (1.0.4)
       ...
       Your bundle is complete! It was installed to ./vendor/bundle
</code></pre>

<p>The deploy process builds a new temp folder with instructions you provide.
In this example, it will do <code>git:clone</code> and <code>bundle:install</code>.</p>

<br class="post-pre">

</section><section class=" after-pre h3 step_2_move_it_to_releases"><h3 id="step_2_move_it_to_releases" class=" after-pre">Step 2: Move it to releases</h3>
<pre class=" lang- prettyprint right"><code>-----&gt; Moving to releases/4
       $ mv "./tmp/build-128293482394" "releases/4"
-----&gt; Symlinking to current
       $ ln -nfs releases/4 current
</code></pre>

<p>Once the project has been built, it will be moved to <code>releases/</code>. A symlink
called <code>current/</code> will be created to point to the active release.</p>

<br class="post-pre">

</section><section class=" after-pre h3 step_3_launch_it"><h3 id="step_3_launch_it" class=" after-pre">Step 3: Launch it</h3>
<pre class=" lang- prettyprint right"><code>-----&gt; Launching
       $ cd releases/4
       $ sudo service nginx restart
-----&gt; Done. Deployed v4
</code></pre>

<p>Invoke the commands queued up in the <code>to :launch</code> block. These often
commands to restart the webserver process. Once this in complete, you're done!</p>

<br class="post-pre">

</section><section class=" after-pre h3 what_about_failure"><h3 id="what_about_failure" class=" after-pre">What about failure?</h3>
<pre class=" lang- prettyprint right"><code># Lets see what happens if a build fails:
-----&gt; Launching
       $ cd releases/4
       $ sudo service nginx restart
       Starting nginx... error: can't start service
-----&gt; ERROR: Deploy failed.
-----&gt; Cleaning up build
       $ rm -rf tmp/build-128293482394
-----&gt; Unlinking current
       $ ln -nfs releases/3 current
       OK
</code></pre>

<p>If it fails at any point, the release path will be deleted. If any commands are
queued using the <code>to :clean</code> block, they will be ran. It will be as if nothing
happened.</p>

<br class="post-pre">

</section></section><section class=" after-pre h2 directory_structure"><h2 id="directory_structure" class=" after-pre">Directory structure</h2>
<pre class=" lang- prettyprint right"><code>/var/www/flipstack.com/     # The deploy_to path
 |-  releases/              # Holds releases, one subdir per release
 |   |- 2012-06-12-838948
 |   |- 2012-06-23-034828
 |   '- ...
 |-  shared/                # Holds files shared between releases
 |   |- logs/               # Log files are usually stored here
 |   `- ...
 '-  current/               # A symlink to the current release in releases/
</code></pre>

<p>The deploy procedures make the assumption that you have a folder like so:</p>

<br class="post-pre">

<p class=" after-pre">It also assumes that the <code>deploy_to</code> path is fully writeable/readable for the
user we're going to SSH with.</p>

</section><section class=" h2 configuring_settings"><h2 id="configuring_settings">Configuring settings</h2>
<pre class=" lang- prettyprint right"><code class="ruby">set :version, "v2.0.5"

settings.version    #=&gt; "v2.0.5"
settings.version?   #=&gt; true
</code></pre>

<p>Settings are managed using the <code>set</code> and <code>settings</code> methods. This convention is
inspired by Sinatra and Vlad.</p>

<br class="post-pre">

<pre class=" lang- prettyprint right"><code class="ruby">set :version, "v2.0.5"

version    #=&gt; "v2.0.5"
version?   #=&gt; true
</code></pre>
<p class=" after-pre">You can also retrieve settings without the <code>settings.</code> prefix.</p>

<br class="post-pre">

<section class=" after-pre h3 dynamic_values"><h3 id="dynamic_values" class=" after-pre">Dynamic values</h3>
<pre class=" lang- prettyprint right"><code class="ruby">set :tag, lambda { "release/#{version}" }
set :version, "v2.0.5"

tag    #=&gt; "release/v2.0.5"
</code></pre>

<p>You can also give settings using a lambda. When the setting is retrieved, it
will be evaluated.</p>

<br class="post-pre">

</section><section class=" after-pre h3 inside_and_outside_tasks"><h3 id="inside_and_outside_tasks" class=" after-pre">Inside and outside tasks</h3>
<pre class=" lang- prettyprint right"><code class="ruby">set :admin_email, "johnsmith@gmail.com"

task :email do
  set :message, "Deploy is done"

  system "echo #{message} | mail #{admin_email}"
end
</code></pre>

<p>All of these are accessible inside and outside tasks.</p>

<br class="post-pre">

</section><section class=" after-pre h3 validations"><h3 id="validations" class=" after-pre">Validations</h3>
<pre class=" lang- prettyprint right"><code class="ruby">task :restart do
  queue "#{settings.nginx_path!}/sbin/nginx restart"
end

# $ mina restart
# Error: You must set the :nginx_path setting
</code></pre>

<p>If you would like an error to be thrown if a setting is not present, add a bang
at the end.</p>

<br class="post-pre">

</section></section><section class=" after-pre h2 defaults"><h2 id="defaults" class=" after-pre">Defaults</h2>

<p>There are a few deploy-related tasks and settings that are on by default.</p>

<section class=" h3 base_settings"><h3 id="base_settings">Base settings</h3>

<ul>
<li><p><code>verbose_mode</code> - True if the <code>--verbose</code> flag is on, false otherwise. Used to
signal if commands are to be shown.</p></li>
<li><p><code>simulate_mode</code> - True if <code>--simulate</code> flag is on, false otherwise. Used to
signal if no SSH connections are to be made, and the scripts will just be
printed locally.</p></li>
<li><p><code>term_mode</code> - If set to <code>:pretty</code>, prettifies the output with indentations.
(Default with deploys.)</p></li>
</ul></section><section class=" h3 ssh_settings"><h3 id="ssh_settings">SSH settings</h3>
<pre class=" lang- prettyprint right"><code class="ruby"># Example:
set :domain, 'flipstack.me'
set :user, 'flipstack_www'
set :identity_file, 'flipstack.pem'
</code></pre>

<ul>
<li><p><code>domain</code> - Hostname to SSH to. <em>Required.</em></p></li>
<li><p><code>user</code> - Username to connect to SSH with. Optional.</p></li>
<li><p><code>identity_file</code> - Local path to the SSH key to use. Optional.</p></li>
</ul>
<br class="post-pre">

</section><section class=" after-pre h3 deploy_settings"><h3 id="deploy_settings" class=" after-pre">Deploy settings</h3>
<pre class=" lang- prettyprint right"><code class="ruby"># Example:
set :deploy_to, '/var/www/flipstack.me'
set :releases_path, 'releases'
set :shared_path, 'shared'
set :current_path, 'current'
set :lock_file, 'deploy.lock'

# This means the following paths will be
# created on `mina setup`:
#    /var/www/flipstack.me/
#    /var/www/flipstack.me/releases/
#    /var/www/flipstack.me/shared/
</code></pre>

<ul>
<li><p><code>deploy_to</code> - Path to deploy to. <em>Required.</em></p></li>
<li><p><code>releases_path</code> - The path to where releases are kept. Defaults to
<code>releases</code>.</p></li>
<li><p><code>shared_path</code> - Where shared files are kept. Defaults to
<code>shared</code>.</p></li>
<li><p><code>current_path</code> - The path to the symlink to the current release. Defaults to
<code>current</code>.</p></li>
<li><p><code>lock_file</code> - The deploy lock file. A deploy does not start if this file is
found. Defaults to <code>deploy.lock</code>.</p></li>
</ul>
<br class="post-pre">

</section><section class=" after-pre h3 task_-_setup"><h3 id="task_-_setup" class=" after-pre">Task - setup</h3>
<pre class=" lang- prettyprint right"><code>$ mina setup
-----&gt; Setting up
       $ mkdir -p /var/www/kickstack.me
       $ chmod g+r,a+rwx /var/www/kickstack.me
       $ mkdir -p /var/www/kickstack.me/releases
       $ mkdir -p /var/www/kickstack.me/shared
       ...
</code></pre>

<p>Prepares the <code>deploy_to</code> directory for deployments. Sets up subdirectories and
sets permissions in the path.</p>

<br class="post-pre">

</section><section class=" after-pre h3 task_-_deploy_force_unlock"><h3 id="task_-_deploy_force_unlock" class=" after-pre">Task - deploy:force_unlock</h3>
<pre class=" lang- prettyprint right"><code>$ mina deploy
-----&gt; ERROR: another deployment is ongoing.
       Delete the lock file to continue.

$ mina deploy:force_unlock
-----&gt; Unlocking
       $ rm /var/www/kickstack.me/deploy.lock

$ mina deploy
# The deploy should proceed now
</code></pre>

<p>Removes the deploy lock file. If a deploy is terminated midway, it may leave a
lock file to signal that deploys shouldn't be made. This forces the removal of
that lock file.</p>

<br class="post-pre">

</section></section><section class=" after-pre h2 addons_git"><h2 id="addons_git" class=" after-pre">Addons: Git</h2>
<pre class=" lang- prettyprint right"><code class="ruby">require 'mina/git'

set :repository, 'https://github.com/you/your-app.git'
</code></pre>

<p>To deploy projects using git, add this to your <code>deploy.rb</code>:</p>

<br class="post-pre">

<section class=" after-pre h3 settings"><h3 id="settings" class=" after-pre">Settings</h3>

<p>This introduces the following settings:</p>

<ul>
<li><p><code>repository</code> - The repository path to clone from. <em>Required.</em></p></li>
<li><p><code>revision</code> - The SHA1 of the commit to be deployed. Defaults to whatever is
the current HEAD in your local copy.</p></li>
</ul></section><section class=" h3 task_-_git_clone"><h3 id="task_-_git_clone">Task - git:clone</h3>

<p>Clones from the repo into the current folder.</p>

</section></section><section class=" h2 addons_bundler"><h2 id="addons_bundler">Addons: Bundler</h2>
<pre class=" lang- prettyprint right"><code class="ruby">require 'mina/bundler'
</code></pre>

<p>To manage Bundler installations, add this to your <code>deploy.rb</code>:</p>

<br class="post-pre">

<section class=" after-pre h3 settings"><h3 id="settings" class=" after-pre">Settings</h3>

<p>This introduces the following settings:</p>

<ul>
<li><p><code>bundle_path</code> - The path where bundles are going to be installed. Defaults to
<code>./vendor/bundler</code>.</p></li>
<li><p><code>bundle_options</code> - Options that will be passed onto <code>bundle install</code>.<br>
Defaults to
<code>--without development:test --path "#{bundle_path}" --binstubs bin/
--deployment"</code>.</p></li>
</ul></section><section class=" h3 task_-_bundle_install"><h3 id="task_-_bundle_install">Task - bundle:install</h3>

<p>Invokes <code>bundle:install</code> on the current directory, creating the bundle
path (specified in <code>bundle_path</code>), and invoking <code>bundle install</code>.</p>

<p>The <code>bundle_path</code> is only created if <code>bundle_path</code> is set (which is on
by default).</p>

</section></section><section class=" h2 addons_rails"><h2 id="addons_rails">Addons: Rails</h2>
<pre class=" lang- prettyprint right"><code class="ruby">require 'mina/rails'
</code></pre>

<p>To manage Rails project installations, add this to your <code>deploy.rb</code>:</p>

<br class="post-pre">

<section class=" after-pre h3 settings"><h3 id="settings" class=" after-pre">Settings</h3>

<p>This introduces the following settings. All of them are optional.</p>

<ul>
<li><p><code>bundle_prefix</code> - Prefix to run commands via Bundler. Defaults to
<code>RAILS_ENV="#{rails_env}" bundle exec</code>.</p></li>
<li><p><code>rake</code> - The <code>rake</code> command. Defaults to <code>#{bundle_prefix} rake</code>.</p></li>
<li><p><code>rails</code> - The <code>rails</code> command. Defaults to <code>#{bundle_prefix} rails</code>.</p></li>
<li><p><code>rails_env</code> - The environment to run rake commands in. Defaults to
<code>production</code>.</p></li>
</ul></section><section class=" h3 task_-_rails_db_migrate"><h3 id="task_-_rails_db_migrate">Task - rails:db_migrate</h3>

<p>Invokes rake to migrate the database using <code>rake db:migrate</code>.</p>

</section><section class=" h3 task_-_rails_assets_precompile"><h3 id="task_-_rails_assets_precompile">Task - rails:assets_precompile</h3>

<p>Precompiles assets. This invokes <code>rake assets:precomplie</code>.</p>

<p>It also checks the current version to see if it has assets compiled. If it does,
it reuses them, skipping the compilation step. To stop this behavior, invoke
the <code>mina</code> command with <code>force_assets=1</code>.</p>

</section><section class=" h3 task_-_rails_assets_precompile_force"><h3 id="task_-_rails_assets_precompile_force">Task - rails:assets_precompile:force</h3>

<p>Precompiles assets. This always skips the "reuse old assets if possible" step.</p>

</section></section><section class=" h2 development_testing"><h2 id="development_testing">Development &amp; testing</h2>
<pre class=" lang- prettyprint right"><code># Run specs
$ rspec
$ rspec -t ssh     # Run SSH tests (read test_env/config/deploy.rb first)
$ rake=0.9 rspec
$ rake=0.8 rspec

# Alias your 'mina' to use it everywhere
$ alias mina="`pwd -LP`/bin/mina"
</code></pre>

<p>To test out stuff in development:</p>

<br class="post-pre">

<section class=" after-pre h3 doing_test_deploys"><h3 id="doing_test_deploys" class=" after-pre">Doing test deploys</h3>
<pre class=" lang- prettyprint right"><code>$ cd test_env
$ mina deploy --simulate
$ mina deploy

# There's an rspec task for it too
$ rspec -t ssh
</code></pre>

<p>Try out the test environment:</p>

<br class="post-pre">

</section><section class=" after-pre h3 gem_management"><h3 id="gem_management" class=" after-pre">Gem management</h3>
<pre class=" lang- prettyprint right"><code># To release the gem:
# Install the Git changelog helper: https://gist.github.com/2880525
$ vim lib/mina/version.rb
$ git clog -w
$ vim HISTORY.md
$ rake release

$ rake build      # Builds the gem file
$ rake install    # Installs the gem locally
</code></pre>

<br class="post-pre">

</section></section><section class=" after-pre h2 acknowledgements"><h2 id="acknowledgements" class=" after-pre">Acknowledgements</h2>

<p>© 2012, Nadarei. Released under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT 
License</a>.</p>

<p>Mina is authored and maintained by <a href="http://ricostacruz.com">Rico Sta. Cruz</a> and <a href="http://devblog.michaelgalero.com/">Michael 
Galero</a> with help from its <a href="http://github.com/nadarei/mina/contributors">contributors</a>. It is sponsored by our 
startup, <a href="http://nadarei.co">Nadarei</a>.</p>

<ul>
<li>
<a href="http://nadarei.co">Nadarei</a> (nadarei.co)</li>
<li>
<a href="http://github.com/nadarei">Github</a> (@nadarei)</li>
</ul>
<p>Rico:</p>

<ul>
<li>
<a href="http://ricostacruz.com">My website</a> (ricostacruz.com)</li>
<li>
<a href="http://github.com/rstacruz">Github</a> (@rstacruz)</li>
<li>
<a href="http://twitter.com/rstacruz">Twitter</a> (@rstacruz)</li>
</ul>
<p>Michael:</p>

<ul>
<li>
<a href="http://devblog.michaelgalero.com/">My website</a> (michaelgalero.com)</li>
<li>
<a href="http://github.com/mikong">Github</a> (@mikong)</li>
</ul></section><aside id="toc"><h1>Mina 
</h1>
<nav class="level-2"><h3><a href="#features">Features</a></h3>
<ul></ul></nav><nav class="level-2"><h3><a href="#setting_up_a_project">Setting up a project</a></h3>
<ul>
<li><a href="#step_1_create_a_config_deploy_rb">Step 1: Create a config/deploy.rb</a></li>
<li><a href="#step_2_set_up_your_server">Step 2: Set up your server</a></li>
<li><a href="#step_3_run_mina_setup">Step 3: Run 'mina setup'</a></li>
<li><a href="#step_4_deploy">Step 4: Deploy!</a></li>
</ul></nav><nav class="level-2"><h3><a href="#command_line_options">Command line options</a></h3>
<ul></ul></nav><nav class="level-2"><h3><a href="#about_deploy_rb">About deploy.rb</a></h3>
<ul></ul></nav><nav class="level-2"><h3><a href="#the_command_queue">The command queue</a></h3>
<ul></ul></nav><nav class="level-2"><h3><a href="#subtasks">Subtasks</a></h3>
<ul></ul></nav><nav class="level-2"><h3><a href="#deploying">Deploying</a></h3>
<ul></ul></nav><nav class="level-2"><h3><a href="#how_deploying_works">How deploying works</a></h3>
<ul>
<li><a href="#step_1_build_it">Step 1: Build it</a></li>
<li><a href="#step_2_move_it_to_releases">Step 2: Move it to releases</a></li>
<li><a href="#step_3_launch_it">Step 3: Launch it</a></li>
<li><a href="#what_about_failure">What about failure?</a></li>
</ul></nav><nav class="level-2"><h3><a href="#directory_structure">Directory structure</a></h3>
<ul></ul></nav><nav class="level-2"><h3><a href="#configuring_settings">Configuring settings</a></h3>
<ul>
<li><a href="#dynamic_values">Dynamic values</a></li>
<li><a href="#inside_and_outside_tasks">Inside and outside tasks</a></li>
<li><a href="#validations">Validations</a></li>
</ul></nav><nav class="level-2"><h3><a href="#defaults">Defaults</a></h3>
<ul>
<li><a href="#base_settings">Base settings</a></li>
<li><a href="#ssh_settings">SSH settings</a></li>
<li><a href="#deploy_settings">Deploy settings</a></li>
<li><a href="#task_-_setup">Task - setup</a></li>
<li><a href="#task_-_deploy_force_unlock">Task - deploy:force_unlock</a></li>
</ul></nav><nav class="level-2"><h3><a href="#addons_git">Addons: Git</a></h3>
<ul>
<li><a href="#settings">Settings</a></li>
<li><a href="#task_-_git_clone">Task - git:clone</a></li>
</ul></nav><nav class="level-2"><h3><a href="#addons_bundler">Addons: Bundler</a></h3>
<ul>
<li><a href="#settings">Settings</a></li>
<li><a href="#task_-_bundle_install">Task - bundle:install</a></li>
</ul></nav><nav class="level-2"><h3><a href="#addons_rails">Addons: Rails</a></h3>
<ul>
<li><a href="#settings">Settings</a></li>
<li><a href="#task_-_rails_db_migrate">Task - rails:db_migrate</a></li>
<li><a href="#task_-_rails_assets_precompile">Task - rails:assets_precompile</a></li>
<li><a href="#task_-_rails_assets_precompile_force">Task - rails:assets_precompile:force</a></li>
</ul></nav><nav class="level-2"><h3><a href="#development_testing">Development &amp; testing</a></h3>
<ul>
<li><a href="#doing_test_deploys">Doing test deploys</a></li>
<li><a href="#gem_management">Gem management</a></li>
</ul></nav><nav class="level-2"><h3><a href="#acknowledgements">Acknowledgements</a></h3>
<ul></ul></nav></aside></div>
  <script type='text/javascript' src='http://cachedcommons.org/cache/prettify/1.0.0/javascripts/prettify-min.js'></script>
  <script>prettyPrint();</script>
</body>
</html>
